import json
import subprocess

# Path to the JSON file
json_file = "/path/to/your.json"  # Update this with the actual JSON file path

# Load JSON data
try:
    with open(json_file, "r") as f:
        data = json.load(f)
except FileNotFoundError:
    print(f"Error: JSON file not found at {json_file}")
    exit(1)
except json.JSONDecodeError:
    print(f"Error: Invalid JSON format in {json_file}")
    exit(1)

print("Executing version checks...")
print("---------------------------------")

# Iterate over each command in the JSON
for package, info in data.items():
    cmd = info.get("command", "")

    if not cmd:
        print(f"{package}: No command found")
        continue

    print(f"Running check for: {package}")
    print(f"Executing: {cmd}")

    try:
        # Execute command and capture output
        result = subprocess.run(cmd, shell=True, check=True, text=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        output = result.stdout.strip()
    except subprocess.CalledProcessError as e:
        output = f"Command failed: {e.stderr.strip()}"

    # Display result
    print(f"{package}: {output}")
    print("---------------------------------")

print("Done.")
