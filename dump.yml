#!/bin/bash

JSON_FILE="/path/to/your.json"  # Update this with the actual JSON file path

if [[ ! -f "$JSON_FILE" ]]; then
    echo "Error: JSON file not found at $JSON_FILE"
    exit 1
fi

echo "Executing version checks..."
echo "---------------------------------"

# Process each command in the JSON file
jq -r 'to_entries[] | "\(.key)@@\(.value.command)"' "$JSON_FILE" | while IFS='@@' read -r name cmd; do
    echo "Running check for: $name"
    echo "Executing: $cmd"  # Debugging: Show command before running

    # Run command and capture result
    result=$(bash -c "$cmd" 2>&1)  

    # Handle empty or failed command execution
    if [[ -z "$result" ]]; then
        echo "$name: Command failed or package not found"
    else
        echo "$name: $result"
    fi

    echo "---------------------------------"
done

echo "Done."
